<!doctype html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inside The Tactics</title>
  <meta name="theme-color" content="#0ea5e9" />
  <link rel="manifest" href="https://raw.githubusercontent.com/andrefrsilva/insidethetactics/refs/heads/main/Manifest.json">
  <link rel="icon" type="image/png" href="https://i.postimg.cc/YCnVNP0h/image.png">
  <link rel="apple-touch-icon" href="https://i.postimg.cc/YCnVNP0h/image.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Inside The Tactics">
  <meta property="og:title" content="Inside The Tactics">
  <meta property="og:description" content="Plataforma profissional para gestão de equipas com gamificação e acesso externo. *****">
  <meta property="og:image" content="https://i.postimg.cc/YCnVNP0h/image.png">
  <meta property="og:url" content="https://insidethetactics.app">
  <meta name="twitter:card" content="summary_large_image">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            display: ["Poppins", "ui-sans-serif", "system-ui"],
            body: ["Inter", "ui-sans-serif", "system-ui"],
          },
          colors: {
            brand: {
              50: '#ecfeff', 100: '#cffafe', 200: '#a5f3fc', 300: '#67e8f9',
              400: '#22d3ee', 500: '#06b6d4', 600: '#0891b2', 700: '#0e7490',
              800: '#155e75', 900: '#164e63',
            },
          }
        }
      }
    }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@500;600;700;800;900&display=swap" rel="stylesheet">

  <script defer src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/customParseFormat.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.34/bundled/lenis.min.js"></script>
  <script defer src="https://unpkg.com/lucide@latest"></script>

  <style>
    :root{
      --accent: #22d3ee;
      --accent-2: #6366f1;
      --glass: rgba(255,255,255,0.06);
      --glass-border: rgba(255,255,255,0.12);
    }
    html,body{height:100%}
    body{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
      background: radial-gradient(1200px 800px at 10% 10%, rgba(34,211,238,0.08), transparent 60%),
                  radial-gradient(1000px 600px at 90% 30%, rgba(99,102,241,0.10), transparent 60%),
                  radial-gradient(800px 800px at 60% 90%, rgba(16,185,129,0.08), transparent 60%),
                  #0b1220;
      color: #e5e7eb;
      overflow-x: hidden;
    }
    .gradient-underline{height: 2px; background: linear-gradient(90deg, var(--accent), var(--accent-2)); filter: blur(0.2px)}
    .glass{background: var(--glass); border:1px solid var(--glass-border); backdrop-filter: blur(10px)}
    .glass-strong{background: rgba(255,255,255,0.10); border: 1px solid rgba(255,255,255,0.18); backdrop-filter: blur(14px)}
    .fade-in{opacity:0; transform: translateY(10px)}
    .avatar-fallback{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg, rgba(99,102,241,0.3), rgba(34,211,238,0.3)); color:#fff;font-weight:700}
    .btn{position:relative; overflow:hidden}
    .btn:before{content:""; position:absolute; inset:-1px; background: linear-gradient(135deg, rgba(34,211,238,0.45), rgba(99,102,241,0.45)); filter: blur(10px); opacity:0; transition:.3s}
    .btn:hover:before{opacity:1}
    #app{opacity:0}
    .nav-scroller{scrollbar-width:none}
    .nav-scroller::-webkit-scrollbar{display:none}
    .shimmer{position:relative; overflow:hidden}
    .shimmer:after{content:""; position:absolute; inset:0; transform:translateX(-100%); background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,0.12), rgba(255,255,255,0)); animation: shimmer 2.2s infinite}
    @keyframes shimmer{100%{transform:translateX(100%)}}
    main{min-height: calc(100vh - 140px)}
    .video-embed{position:relative; width:100%; padding-top:56.25%; border-radius: 1rem; overflow:hidden}
    .video-embed iframe{position:absolute; inset:0; width:100%; height:100%}
  </style>
</head>
<body>
  <div id="loader" class="fixed inset-0 z-[60] grid place-items-center bg-[#0b1220]">
    <div class="text-center">
      <div class="mx-auto w-20 h-20 rounded-3xl border-2 border-white/10 grid place-items-center relative">
        <div class="absolute inset-0 rounded-3xl" style="background: conic-gradient(from 0deg, rgba(34,211,238,.8), rgba(99,102,241,.8), rgba(34,211,238,.8)); filter: blur(12px); opacity:.4"></div>
        <svg class="animate-spin w-8 h-8 text-brand-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10" stroke-opacity=".2"/><path d="M22 12a10 10 0 0 1-10 10"/></svg>
      </div>
      <h1 class="mt-6 font-display text-3xl md:text-4xl">Inside The Tactics</h1>
      <p id="loaderText" class="text-white/70 mt-2">A carregar dados…</p>
    </div>
  </div>

  <div id="loginModal" class="hidden fixed inset-0 z-[70] bg-black/60 backdrop-blur-sm p-4">
    <div class="max-w-md mx-auto mt-16 glass-strong rounded-2xl p-6 shadow-xl">
      <div class="flex items-center gap-3 mb-4">
        <svg data-lucide="lock" class="w-6 h-6 text-brand-300"></svg>
        <h2 class="font-display text-2xl">Entrar</h2>
      </div>
      <p class="text-white/70 text-sm mb-5">Introduza o <b>user</b> e a <b>pass</b> que constam na folha <i>login</i> do Excel.</p>
      <form id="loginForm" class="space-y-4">
        <div>
          <label class="block text-sm text-white/70 mb-1" for="user">User</label>
          <input id="user" autocomplete="username" class="w-full glass rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-brand-400" placeholder="o seu utilizador" />
        </div>
        <div>
          <label class="block text-sm text-white/70 mb-1" for="pass">Pass</label>
          <input id="pass" type="password" autocomplete="current-password" class="w-full glass rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-brand-400" placeholder="a sua palavra-passe" />
        </div>
        <div id="loginError" class="hidden text-red-300 text-sm">Login inválido. Tente novamente.</div>
        <div class="flex items-center justify-between pt-2">
          <button type="button" id="clearStoredLogin" class="text-xs text-white/60 hover:text-white/90 underline">Apagar login guardado</button>
          <button type="submit" class="btn relative inline-flex items-center gap-2 bg-white/10 hover:bg-white/15 border border-white/15 rounded-xl px-5 py-2.5">
            <svg data-lucide="log-in" class="w-4 h-4"></svg>
            <span>Entrar</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <header class="sticky top-0 z-50 backdrop-blur supports-[backdrop-filter]:bg-white/5 bg-white/0">
    <div class="gradient-underline"></div>
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-brand-400/80 to-indigo-500/80 grid place-items-center ring-1 ring-white/20 shadow">
          <svg viewBox="0 0 24 24" class="w-5 h-5 text-white" fill="none" stroke="currentColor" stroke-width="1.6"><path d="M12 2l8 4-8 4-8-4 8-4Z"/><path d="M4 10l8 4 8-4"/><path d="M4 16l8 4 8-4"/></svg>
        </div>
        <div>
          <div class="font-display text-lg leading-tight">Inside The Tactics</div>
          <div class="text-[11px] uppercase tracking-widest text-white/60">Pro · Analytics</div>
        </div>
      </div>

      <!-- Nav is ALWAYS hidden on mobile; JS decides overflow behavior on desktop -->
      <nav id="navWrap" class="ml-auto overflow-x-hidden hidden md:block">
        <ul id="menu" class="flex items-center gap-2 md:gap-3 min-w-max"></ul>
      </nav>

      <!-- Hamburger: visible on mobile by default; JS can force-show on desktop if overflow -->
      <button id="menuToggle" aria-label="Abrir menu" class="ml-auto btn md:hidden inline-flex items-center gap-2 bg-white/10 hover:bg-white/15 border border-white/15 rounded-xl px-3 py-2">
        <svg data-lucide="menu" class="w-5 h-5"></svg><span class="hidden sm:inline text-sm">Menu</span>
      </button>
    </div>
  </header>

  <main id="app" class="opacity-0 transition-opacity duration-500">
    <section id="content" class="max-w-7xl mx-auto px-4 py-8 md:py-10"></section>
  </main>

  <footer class="mt-10 border-t border-white/10">
    <div class="max-w-7xl mx-auto px-4 py-8 flex items-center justify-between text-sm text-white/60">
      <div>© <span id="year"></span> Tomás Silva • Inside The Tactics</div>
      <div>Portugal</div>
    </div>
  </footer>

  <!-- Overlay menu -->
  <div id="overlayMenu" class="hidden fixed inset-0 z-[65]">
    <div class="absolute inset-0 bg-black/60" id="overlayBg"></div>
    <div class="absolute right-3 top-3 sm:right-6 sm:top-6 w-[88vw] max-w-sm glass-strong rounded-2xl p-3 sm:p-4 shadow-2xl">
      <div class="flex items-center justify-between mb-2">
        <div class="font-display text-lg">Menu</div>
        <button id="overlayClose" class="btn inline-flex items-center justify-center rounded-xl border border-white/15 px-2.5 py-2 hover:bg-white/10" aria-label="Fechar menu">
          <svg data-lucide="x" class="w-4 h-4"></svg>
        </button>
      </div>
      <div id="overlayMenuItems" class="grid gap-2"></div>
    </div>
  </div>

  <!-- Game picker (desktop) -->
  <div id="gamePickerOverlay" class="hidden fixed inset-0 z-[66]">
    <div class="absolute inset-0 bg-black/60" id="gpBackdrop"></div>
    <div class="absolute left-1/2 top-12 -translate-x-1/2 w-max max-w-[calc(100vw-2rem)] glass-strong rounded-2xl p-3 sm:p-4 shadow-2xl">
      <div class="flex items-center justify-between gap-3 mb-2">
        <div class="font-display text-lg truncate">Selecionar jogo</div>
        <button id="gpClose" class="btn inline-flex items-center justify-center rounded-xl border border-white/15 px-2.5 py-2 hover:bg-white/10" aria-label="Fechar seleção">
          <svg data-lucide="x" class="w-4 h-4"></svg>
        </button>
      </div>
      <!-- one-per-line list -->
      <div id="gpList" class="grid grid-cols-1 gap-2 max-h-[60vh] overflow-y-auto pr-1"></div>
    </div>
  </div>

  <script>
    const EXCEL_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTLT1g4vrloKXo6t6dYcrJMA-ULByWSaT4dutbDhv3dx2S_2dxWPyzsIn5wJgTsGAlLEHbCxUs1ZL1q/pub?output=xlsx";
    const STORAGE_KEY = "itt_login";

    const State = {
      dataLoaded: false,
      sheets: {},
      headers: {},
      rankings: [],
      user: null,
      activePage: "Plantel",
      equipe: [],
      jogos: [],
      campeonato: [],
      arquivo: [],
    };

    if (window.dayjs && window.dayjs_plugin_customParseFormat) {
      dayjs.extend(window.dayjs_plugin_customParseFormat);
    }
    const norm = (s) => (s||"").toString().trim();
    const normLower = (s) => norm(s).toLowerCase();

    const tryParseDate = (s) => {
      if(!s) return null;
      const strict = ["DD/MM/YYYY","D/M/YYYY","YYYY-MM-DD","YYYY/M/D","DD-MM-YYYY","D-M-YYYY","YYYY.MM.DD"];
      for(const fmt of strict){
        const d = dayjs(s, fmt, true);
        if(d.isValid()) return d;
      }
      const d2 = dayjs(s);
      return d2.isValid() ? d2 : null;
    };

    const calcAge = (dateStr) => {
      const d = tryParseDate(dateStr);
      if(!d) return null;
      const now = dayjs();
      let age = now.year() - d.year();
      if(now.month() < d.month() || (now.month() === d.month() && now.date() < d.date())) age--;
      return age;
    };

    const PT_MONTHS_SHORT = ['jan','fev','mar','abr','mai','jun','jul','ago','set','out','nov','dez'];
    const PT_MONTHS_LONG  = ['Janeiro','Fevereiro','Março','Abril','Maio','Junho','Julho','Agosto','Setembro','Outubro','Novembro','Dezembro'];
    const PT_WEEKDAYS     = ['Domingo','Segunda Feira','Terça Feira','Quarta Feira','Quinta Feira','Sexta Feira','Sábado'];

    function formatDMShortPT(dateStr){
      const d = tryParseDate(dateStr);
      if(!d || !d.isValid()) return String(dateStr ?? '');
      const dd = String(d.date()).padStart(2,'0');
      const mon = PT_MONTHS_SHORT[d.month()];
      return dd + '/' + mon;
    }
    function formatLongPT(dateStr){
      const d = tryParseDate(dateStr);
      if(!d || !d.isValid()) return String(dateStr ?? '');
      const wd = PT_WEEKDAYS[d.day()];
      const dd = String(d.date()).padStart(2,'0');
      const mon = PT_MONTHS_LONG[d.month()];
      const yy = d.year();
      return wd + ', ' + dd + '/' + mon + '/' + yy;
    }
    function formatTimeHHMM(val){
      if(val instanceof Date){
        try{ return val.toLocaleTimeString('pt-PT',{hour:'2-digit',minute:'2-digit',hour12:false}); }catch(e){}
      }
      const s = String(val ?? '').trim();
      if(!s) return '';
      const d = dayjs(s, ['HH:mm','H:mm','HH:mm:ss','H:mm:ss','YYYY-MM-DDTHH:mm:ss','YYYY-MM-DD HH:mm:ss'], true);
      if(d.isValid()) return d.format('HH:mm');
      const m = s.match(/(\d{1,2}):(\d{2})/);
      if(m) return m[1].padStart(2,'0') + ':' + m[2];
      const d2 = dayjs(s); if(d2.isValid()) return d2.format('HH:mm');
      return s;
    }
    function formatDDMMYYYY(dateStr){
      const d = tryParseDate(dateStr);
      return (d && d.isValid()) ? d.format('DD/MM/YYYY') : String(dateStr ?? '');
    }

    function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, (c) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c])); }
    function avatar(name){
      const initials = (name||'').split(/\s+/).filter(Boolean).slice(0,2).map(p=>p[0]?.toUpperCase()).join('') || '?';
      return `<div class="avatar-fallback w-full h-full">${initials}</div>`;
    }
    function miniAvatar(name){
      const initials = (name||'').split(/\s+/).filter(Boolean).slice(0,2).map(p=>p[0]?.toUpperCase()).join('') || '?';
      return `<div class="avatar-fallback w-full h-full text-sm">${initials}</div>`;
    }

    function loadScript(src){
      return new Promise((resolve, reject) => {
        const s = document.createElement('script');
        s.src = src; s.async = true; s.onload = resolve; s.onerror = () => reject(new Error('Falha a carregar script: '+src));
        document.head.appendChild(s);
      });
    }
    async function ensureXLSX(){
      if(window.XLSX) return;
      const cdns = [
        'https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js',
        'https://unpkg.com/xlsx@0.18.5/dist/xlsx.full.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js'
      ];
      for(const src of cdns){
        try{ await loadScript(src); if(window.XLSX) return; }catch(e){ console.warn(e.message); }
      }
      throw new Error('Biblioteca XLSX não carregou');
    }

    async function fetchGVizSheet(sheet){
      const bust = Date.now();
      const base = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTLT1g4vrloKXo6t6dYcrJMA-ULByWSaT4dutbDhv3dx2S_2dxWPyzsIn5wJgTsGAlLEHbCxUs1ZL1q/gviz/tq";
      const url = `${base}?tqx=out:json&sheet=${encodeURIComponent(sheet)}&ts=${bust}`;
      const res = await fetch(url, { cache: 'no-store' });
      if(!res.ok) throw new Error('GViz HTTP '+res.status);
      const txt = await res.text();
      const i = txt.indexOf('('), j = txt.lastIndexOf(')');
      if(i<0||j<0) throw new Error('GViz payload inválido');
      const json = JSON.parse(txt.slice(i+1, j));
      const table = json.table || {};
      const headers = (table.cols||[]).map(c => c.label || c.id || '').map(String);
      const rows = (table.rows||[]).map(r => {
        const obj = {};
        headers.forEach((h, idx) => {
          const c = r.c ? r.c[idx] : null;
          obj[h] = c ? (c.f ?? c.v ?? '') : '';
        });
        return obj;
      });
      return { headers, rows };
    }
    function csvUrlFor(sheet){
      const base = EXCEL_URL.replace('output=xlsx','output=csv');
      const bust = Date.now();
      return `${base}&sheet=${encodeURIComponent(sheet)}&ts=${bust}`;
    }
    async function fetchCSVSheet(sheet){
      const res = await fetch(csvUrlFor(sheet), { cache:'no-store' });
      if(!res.ok) throw new Error('CSV HTTP '+res.status);
      const text = await res.text();
      return parseCSV(text);
    }
    function parseCSV(text){
      const rows = [];
      let i=0, field='', row=[], inQuotes=false;
      while(i < text.length){
        const ch = text[i];
        if(inQuotes){
          if(ch==='"'){
            if(text[i+1]==='"'){ field += '"'; i++; } else { inQuotes=false; }
          } else { field += ch; }
        } else {
          if(ch==='"') { inQuotes=true; }
          else if(ch===','){ row.push(field); field=''; }
          else if(ch==='\n' || ch==='\r'){
            if(field!=='' || row.length){ row.push(field); rows.push(row); row=[]; field=''; }
            if(ch==='\r' && text[i+1]==='\n') i++;
          } else { field += ch; }
        }
        i++;
      }
      if(field!=='' || row.length) { row.push(field); rows.push(row); }
      const headers = (rows.shift()||[]).map(h => String(h));
      const objs = rows.map(r => { const o={}; headers.forEach((h,idx)=>{ o[h] = r[idx] ?? ''; }); return o; });
      return { headers, rows: objs };
    }

    async function fetchExcelLatest(){
      const loaderText = document.getElementById('loaderText');
      loaderText.textContent = 'A descarregar a versão mais recente…';

      try{
        await ensureXLSX();
        const resp = await fetch(`${EXCEL_URL}&ts=${Date.now()}`, { cache: 'no-store', mode: 'cors', redirect: 'follow' });
        if(!resp.ok) throw new Error('Falha no download do Excel');
        const buf = await resp.arrayBuffer();
        loaderText.textContent = 'A ler e processar o Excel…';

        const wb = XLSX.read(buf, { type: 'array', cellDates: true, cellNF: false, cellText: false });
        const sheetBy = (name) => { const keys = Object.keys(wb.Sheets); const found = keys.find(k => normLower(k) === normLower(name)); return wb.Sheets[found || name]; };

        const shLogin   = sheetBy('login');
        const shEquipa  = sheetBy('equipa');
        const shJogos   = sheetBy('jogos');
        const shCamp    = sheetBy('campeonato');
        const shArquivo = sheetBy('arquivo');

        if(!shLogin || !shEquipa) throw new Error('Folhas essenciais em falta (login/equipa)');

        const eqHeaderRows = XLSX.utils.sheet_to_json(shEquipa, { header: 1 });
        const eqHeaders = (eqHeaderRows && eqHeaderRows[0] ? eqHeaderRows[0] : []).filter(Boolean).map(h => h.toString());
        const rankingHeaders = eqHeaders.filter(h => /^\s*(ranking|rahnking)\s*:/i.test(h));

        const loginRows   = XLSX.utils.sheet_to_json(shLogin,   { defval: "" });
        const equipeRows  = XLSX.utils.sheet_to_json(shEquipa,  { defval: "" });
        const jogosRows   = shJogos   ? XLSX.utils.sheet_to_json(shJogos,   { defval: "" }) : [];
        const campRows    = shCamp    ? XLSX.utils.sheet_to_json(shCamp,    { defval: "" }) : [];
        const arquivoRows = shArquivo ? XLSX.utils.sheet_to_json(shArquivo, { defval: "" }) : [];

        const normLogin = loginRows.map(r => { const map={}; for(const k of Object.keys(r)) map[normLower(k)]=r[k];
          return { raw:r, user: map['user'] ?? map['utilizador'] ?? map['login'] ?? '', pass: map['pass'] ?? map['password'] ?? '', nome: map['nome'] ?? map['nomes'] ?? '', numero: map['número'] ?? map['numero'] ?? '', }; });

        State.headers.equipa = eqHeaders;
        State.rankings = rankingHeaders;
        State.sheets = { login: normLogin, equipa: equipeRows, jogos: jogosRows, campeonato: campRows, arquivo: arquivoRows };
        State.equipe = equipeRows;
        State.jogos = jogosRows;
        State.campeonato = campRows;
        State.arquivo = arquivoRows;
        State.dataLoaded = true;
        return;
      }catch(err){
        console.warn('XLSX falhou, a tentar fallback GViz/CSV', err);
      }

      loaderText.textContent = 'A obter dados (fallback)…';
      let login, equipa, jogos, campeonato, arquivo;
      let gvizOk = false;
      try{
        [login, equipa, jogos, campeonato, arquivo] = await Promise.all([
          fetchGVizSheet('login'),
          fetchGVizSheet('equipa'),
          fetchGVizSheet('jogos').catch(()=>({headers:[],rows:[]})),
          fetchGVizSheet('campeonato').catch(()=>({headers:[],rows:[]})),
          fetchGVizSheet('arquivo').catch(()=>({headers:[],rows:[]})),
        ]);
        gvizOk = true;
      }catch(e){ console.warn('GViz também falhou', e); }

      if(!gvizOk){
        [login, equipa, jogos, campeonato, arquivo] = await Promise.all([
          fetchCSVSheet('login'),
          fetchCSVSheet('equipa'),
          fetchCSVSheet('jogos').catch(()=>({headers:[],rows:[]})),
          fetchCSVSheet('campeonato').catch(()=>({headers:[],rows:[]})),
          fetchCSVSheet('arquivo').catch(()=>({headers:[],rows:[]})),
        ]);
      }

      const rankingHeaders = (equipa.headers||[]).filter(h => /^\s*(ranking|rahnking)\s*:/i.test(String(h)));

      const normLogin = (login.rows||[]).map(r => { const map={}; Object.keys(r).forEach(k=> map[normLower(k)] = r[k]);
        return { raw:r, user: map['user'] ?? map['utilizador'] ?? map['login'] ?? '', pass: map['pass'] ?? map['password'] ?? '', nome: map['nome'] ?? map['nomes'] ?? '', numero: map['número'] ?? map['numero'] ?? '', }; });

      State.headers.equipa = equipa.headers||[];
      State.rankings = rankingHeaders;
      State.sheets = { login: normLogin, equipa: (equipa.rows||[]), jogos: (jogos.rows||[]), campeonato: (campeonato.rows||[]), arquivo: (arquivo.rows||[]) };
      State.equipe = (equipa.rows||[]);
      State.jogos = (jogos.rows||[]);
      State.campeonato = (campeonato.rows||[]);
      State.arquivo = (arquivo.rows||[]);
      State.dataLoaded = true;
    }

    function showLogin(){ document.getElementById('loginModal').classList.remove('hidden'); setTimeout(()=>document.getElementById('user').focus(), 50); }
    function hideLogin(){ document.getElementById('loginModal').classList.add('hidden'); }

    function initLoginUI(){
      const form = document.getElementById('loginForm');
      const err = document.getElementById('loginError');
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const user = document.getElementById('user').value;
        const pass = document.getElementById('pass').value;
        if(validateCredentials(user, pass)){
          localStorage.setItem(STORAGE_KEY, JSON.stringify({ user, pass }));
          err.classList.add('hidden'); hideLogin(); startApp();
        }else{
          err.classList.remove('hidden');
        }
      });
      document.getElementById('clearStoredLogin').onclick = () => {
        localStorage.removeItem(STORAGE_KEY);
        document.getElementById('user').value = '';
        document.getElementById('pass').value = '';
        document.getElementById('user').focus();
      };
    }

    function validateStoredLogin(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return false;
      try{
        const obj = JSON.parse(raw);
        if(!obj.user || !obj.pass) return false;
        return validateCredentials(obj.user, obj.pass);
      }catch(e){ return false; }
    }

    function validateCredentials(user, pass){
      const list = State.sheets.login || [];
      const u = normLower(user), p = norm(pass);
      const ok = list.some(row => normLower(row.user) === u && norm(row.pass) === p);
      if(ok){ State.user = { user, pass }; }
      return ok;
    }

    const PAGES = ["Plantel", "Rankings", "Convocatória", "Campeonato", "Arquivo"];

    function buildMenu(){
      const ul = document.getElementById('menu');
      ul.innerHTML = '';
      PAGES.forEach((label, idx) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <button data-page="${label}" class="btn group relative px-3 md:px-4 py-2 rounded-xl border border-white/10 hover:bg-white/10 text-sm md:text-[15px] ${idx===0?'bg-white/10':''}">
            <span class="inline-flex items-center gap-2">
              ${iconFor(label)}
              <span>${label}</span>
            </span>
            <span class="absolute inset-0 rounded-xl pointer-events-none" style="box-shadow: inset 0 0 0 1px rgba(255,255,255,0.06);"></span>
          </button>`;
        ul.appendChild(li);
      });

      ul.querySelectorAll('button').forEach(btn => btn.addEventListener('click', (e) => {
        ul.querySelectorAll('button').forEach(b => b.classList.remove('bg-white/10'));
        e.currentTarget.classList.add('bg-white/10');
        navigate(e.currentTarget.dataset.page);
        const wrap = document.getElementById('navWrap');
        if(wrap.dataset.mode && wrap.dataset.mode !== 'desktop') closeOverlayMenu();
      }));

      const overlayItems = document.getElementById('overlayMenuItems');
      overlayItems.innerHTML = '';
      PAGES.forEach((label, idx) => {
        const b = document.createElement('button');
        b.className = 'btn w-full text-left px-3 py-2 rounded-xl border border-white/10 hover:bg-white/10 text-sm';
        b.dataset.page = label;
        b.innerHTML = `<span class="inline-flex items-center gap-2">${iconFor(label)}<span>${label}</span></span>`;
        b.addEventListener('click', () => {
          document.querySelectorAll('#overlayMenuItems button').forEach(x => x.classList.remove('bg-white/10'));
          b.classList.add('bg-white/10');
          navigate(label);
          closeOverlayMenu();
        });
        if(idx===0) b.classList.add('bg-white/10');
        overlayItems.appendChild(b);
      });

      if (window.lucide) window.lucide.createIcons();
      setupResponsiveMenu();
    }

    function iconFor(label){
      const map = {
        'Plantel': '<svg data-lucide="users" class="w-4 h-4"></svg>',
        'Rankings': '<svg data-lucide="trophy" class="w-4 h-4"></svg>',
        'Convocatória': '<svg data-lucide="calendar-check" class="w-4 h-4"></svg>',
        'Campeonato': '<svg data-lucide="list-checks" class="w-4 h-4"></svg>',
        'Arquivo': '<svg data-lucide="library" class="w-4 h-4"></svg>'
      };
      return map[label] || '';
    }

    function navigate(page){
      State.activePage = page;
      if(page === 'Plantel') renderPlantel('jogadores');
      if(page === 'Rankings') renderRankings();
      if(page === 'Convocatória') renderConvocatoria();
      if(page === 'Campeonato') renderCampeonato();
      if(page === 'Arquivo') renderArquivo();
      if (window.lucide) window.lucide.createIcons();
    }

    function reveal(){
      const els = document.querySelectorAll('.fade-in');
      if (window.gsap) {
        els.forEach((el,i) => gsap.to(el, { opacity: 1, y: 0, duration: .35, delay: i*0.03, ease: 'power1.out' }));
      } else {
        els.forEach((el) => { el.style.opacity = 1; el.style.transform = 'none'; });
      }
      if (window.lucide) window.lucide.createIcons();
    }

    function renderPlantel(mode = 'jogadores'){
      const content = document.getElementById('content');
      const btnClass = (active) => `btn px-4 py-2 rounded-xl border border-white/10 ${active? 'bg-white/15':'hover:bg-white/10'}`;

      const players = State.equipe.filter(p => {
        const isStaff = ['eq_tecnica','eq tecnica','eq-tecnica'].some(k => normLower(p[k])==='x');
        return mode === 'jogadores' ? !isStaff : isStaff;
      });

      content.innerHTML = `
        <div class="mb-6 flex items-center gap-2">
          <button id="btnJog" class="${btnClass(mode==='jogadores')}">Jogadores</button>
          <button id="btnTec" class="${btnClass(mode==='equipa')}">Equipa Técnica</button>
        </div>
        <div class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 md:gap-5" id="playerGrid"></div>
      `;

      document.getElementById('btnJog').onclick = () => renderPlantel('jogadores');
      document.getElementById('btnTec').onclick = () => renderPlantel('equipa');

      const grid = document.getElementById('playerGrid');
      grid.innerHTML = '';

      players.forEach((p) => {
        const name = p['name'] || p['nome'] || p['Name'] || '';
        const number = p['number'] || p['número'] || p['numero'] || '';
        const pos = p['position'] || p['posição'] || p['posicao'] || '';
        const birth = p['birthdate'] || p['data de nascimento'] || p['nascimento'] || '';
        const age = calcAge(birth);
        const photo = p['url_photo'] || p['foto'] || '';

        const card = document.createElement('div');
        card.className = 'glass rounded-2xl p-3 md:p-4 hover:translate-y-[-2px] transition shadow-sm fade-in';
        card.innerHTML = `
          <div class="relative">
            <div class="aspect-[4/3] rounded-xl overflow-hidden bg-white/5 shimmer">
              ${photo ? `<img loading="lazy" src="${photo}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML=avatar('${escapeHtml(name)}')">` : `${avatar(name)}`}
            </div>
            ${number?`<div class="absolute -bottom-3 right-3 bg-gradient-to-br from-brand-400 to-indigo-500 text-white text-xs font-bold px-2.5 py-1.5 rounded-xl shadow">#${number}</div>`:''}
          </div>
          <div class="pt-5">
            <div class="font-semibold text-base md:text-lg">${escapeHtml(name)}</div>
            <div class="text-white/70 text-sm">${pos ? escapeHtml(pos) : ''}</div>
            <div class="text-white/60 text-xs mt-1">${birth ? `Nasc.: ${escapeHtml(formatDMShortPT(birth))}${age?` (${age})`:''}`:''}</div>
          </div>
        `;
        grid.appendChild(card);
      });

      reveal();
    }

    function renderRankings(){
      const content = document.getElementById('content');
      if(!State.rankings || !State.rankings.length){
        content.innerHTML = `<div class="text-white/70">Nenhum ranking encontrado. As colunas devem começar por <b>Ranking: </b> (ou “Rahnking: ”) na folha <i>equipa</i>.</div>`;
        return;
      }

      const btns = State.rankings.map(r => {
        const label = String(r).replace(/^\s*(ranking|rahnking)\s*:\s*/i, '');
        return `<button class="btn px-3 py-2 rounded-xl border border-white/10 hover:bg-white/10 text-sm" data-rk="${escapeHtml(r)}">${escapeHtml(label)}</button>`;
      }).join(' ');

      content.innerHTML = `
        <div class="flex flex-wrap items-center gap-2 mb-6">${btns}</div>
        <div id="rkList" class="space-y-2"></div>
      `;

      content.querySelectorAll('[data-rk]').forEach(btn => btn.addEventListener('click', () => showRanking(btn.dataset.rk)));

      showRanking(State.rankings[0]);
      reveal();
    }

    function showRanking(colName){
      const list = document.getElementById('rkList');
      const players = State.equipe.filter(p => !['eq_tecnica','eq tecnica','eq-tecnica'].some(k => normLower(p[k])==='x'));
      const rows = players.map(p => ({
        name: p['name'] || p['nome'] || '',
        photo: p['url_photo'] || '',
        val: p[colName]
      }))
      .filter(r => r.val !== undefined && r.val !== null && norm(r.val) !== '')
      .map(r => ({ ...r, num: Number(String(r.val).toString().replace(',', '.')) }))
      .filter(r => !Number.isNaN(r.num))
      .sort((a,b) => b.num - a.num);

      list.innerHTML = '';
      rows.forEach((r) => {
        const item = document.createElement('div');
        item.className = 'glass rounded-xl p-3 flex items-center justify-between gap-3 fade-in';
        item.innerHTML = `
          <div class="flex items-center gap-3">
            <div class="w-10 h-10 rounded-lg overflow-hidden bg-white/5">
              ${r.photo ? `<img src="${r.photo}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML=miniAvatar('${escapeHtml(r.name)}')">` : miniAvatar(r.name)}
            </div>
            <div class="font-medium">${escapeHtml(r.name)}</div>
          </div>
          <div class="text-right">
            <div class="font-semibold text-base md:text-lg">${escapeHtml(r.num)}</div>
            <div class="text-[10px] uppercase tracking-wider text-white/50">${escapeHtml(String(colName).replace(/^\s*(ranking|rahnking)\s*:\s*/i, ''))}</div>
          </div>
        `;
        list.appendChild(item);
      });
      reveal();
    }

    function getUpcomingJogosSorted(){
      const today = dayjs().startOf('day');
      const valid = (State.jogos||[]).map(j => ({...j, _d: tryParseDate(j['data'])})).filter(j => j._d && !j._d.isBefore(today));
      valid.sort((a,b) => a._d.valueOf() - b._d.valueOf());
      return valid;
    }

    function renderConvocatoria(){
      const content = document.getElementById('content');
      const upcoming = getUpcomingJogosSorted();
      if(!upcoming.length){
        content.innerHTML = `<div class="text-white/70">Sem próximos jogos (a lista omite datas anteriores à data atual).</div>`;
        return;
      }

      const first = upcoming[0];
      const labelFor = (j) => `(${escapeHtml(formatDDMMYYYY(j['data']))}) ${escapeHtml(j['nome']||'')}`;

      content.innerHTML = `
        <div class="flex items-center gap-3 mb-4">
          <button id="openGamePicker" class="hidden sm:inline-flex btn items-center gap-2 bg-white/10 hover:bg-white/15 border border-white/15 rounded-xl px-3 py-2">
            <svg data-lucide="chevrons-up-down" class="w-4 h-4"></svg>
            <span id="openGamePickerLabel" class="truncate max-w-[60vw]">${labelFor(first)}</span>
          </button>

          <div class="sm:hidden w-full">
            <label for="mobileGameSelect" class="sr-only">Selecionar jogo</label>
            <select id="mobileGameSelect" class="w-full glass rounded-xl px-3 py-2 outline-none focus:ring-2 focus:ring-brand-400">
              ${upcoming.map(j => `<option value="${escapeHtml(j['nome']||'')}" ${norm(j['nome'])===norm(first['nome'])?'selected':''}>(${escapeHtml(formatDDMMYYYY(j['data']))}) ${escapeHtml(j['nome']||'')}</option>`).join('')}
            </select>
          </div>
        </div>
        <div id="jogoWrap" class="space-y-6"></div>
      `;

      document.getElementById('openGamePicker').onclick = () => openGamePicker(upcoming, (picked) => {
        document.getElementById('openGamePickerLabel').textContent = labelFor(picked);
        showJogo(picked['nome']||'');
      });
      const mobileSelect = document.getElementById('mobileGameSelect');
      mobileSelect.onchange = (e) => showJogo(e.target.value);

      showJogo(first['nome']);
      reveal();
    }

    function openGamePicker(list, onPick){
      const overlay = document.getElementById('gamePickerOverlay');
      const gpList = document.getElementById('gpList');
      gpList.innerHTML = '';
      list.forEach(j => {
        const line = document.createElement('button');
        // ONE PER LINE, FULL WIDTH
        line.className = 'btn block w-full text-left px-3 py-2 rounded-xl border border-white/10 hover:bg-white/10 text-sm';
        line.innerHTML = `(${escapeHtml(formatDDMMYYYY(j['data']))}) ${escapeHtml(j['nome']||'')}`;
        line.addEventListener('click', () => { closeGamePicker(); onPick(j); });
        gpList.appendChild(line);
      });
      const closeBtn = document.getElementById('gpClose');
      const bg = document.getElementById('gpBackdrop');
      closeBtn.onclick = closeGamePicker;
      bg.onclick = closeGamePicker;
      function onKey(e){ if(e.key==='Escape') closeGamePicker(); }
      overlay.dataset.keyHandler = '1';
      document.addEventListener('keydown', onKey, { once:true });
      overlay.classList.remove('hidden');
      if (window.lucide) window.lucide.createIcons();

      function closeGamePicker(){
        overlay.classList.add('hidden');
      }
    }

    function showJogo(nome){
      const box = document.getElementById('jogoWrap');
      const j = State.jogos.find(r => norm(r['nome']) === norm(nome));
      if(!j){ box.innerHTML = '<div class="text-white/70">Jogo não encontrado.</div>'; return; }

      const localLink = j['link para o local'] || j['link'] || '';
      const localTxt = j['local'] || '';
      const infoTxt = j['informações'] || j['informacoes'] || j['texto'] || j['observações'] || j['observacoes'] || j['notas'] || '';

      const imgs = [];
      for(let k=1;k<=6;k++){
        const val = j[`imagem ${k}`] || j[`Imagem ${k}`] || j[`img ${k}`] || '';
        if(norm(val)) imgs.push(val);
      }
      const galeriaHTML = imgs.length ? `
        <div class="grid grid-cols-2 grid-rows-3 grid-flow-col sm:grid-cols-3 sm:grid-rows-2 sm:grid-flow-row gap-3">
          ${imgs.slice(0,6).map(src => `
            <div class="rounded-xl overflow-hidden border border-white/10 bg-white/5">
              <img loading="lazy" src="${src}" alt="" class="w-full h-full object-cover">
            </div>`).join('')}
        </div>` : '';

      const hasLink = norm(localLink).length>0;
      const localHTML = hasLink
        ? `<a class="underline decoration-dotted hover:text-white break-words" target="_blank" href="${localLink}">${escapeHtml(localTxt)}</a>`
        : `<span class="break-words">${escapeHtml(localTxt)}</span>`;

      box.innerHTML = `
        <div class="glass rounded-2xl p-5">
          <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-4">
            <div class="min-w-0">
              <h3 class="font-display text-2xl break-words">${escapeHtml(j['nome'])}</h3>
              <div class="text-white/70 text-sm">${escapeHtml(formatLongPT(j['data']))}</div>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-sm w-full md:w-auto">
              <div class="glass rounded-xl p-3"><div class="text-white/60 text-xs">Concentração</div><div class="font-medium">${escapeHtml(formatTimeHHMM(j['hora do encontro']))}</div></div>
              <div class="glass rounded-xl p-3"><div class="text-white/60 text-xs">Jogo</div><div class="font-medium">${escapeHtml(formatTimeHHMM(j['hora do jogo']))}</div></div>
              <div class="glass rounded-xl p-3 col-span-2 md:col-span-3">
                <div class="text-white/60 text-xs">Local</div>
                <div class="font-medium">${localHTML}</div>
              </div>
              ${norm(infoTxt) ? `<div class="glass rounded-xl p-3 col-span-2 md:col-span-3">
                  <div class="text-white/60 text-xs">Informações</div>
                  <div class="font-medium whitespace-pre-line break-words">${escapeHtml(infoTxt)}</div>
                </div>` : ''}
            </div>
          </div>
        </div>

        ${galeriaHTML}

        <div>
          <h4 class="font-display text-xl mb-3">Convocados</h4>
          <div class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4" id="convGrid"></div>
        </div>
      `;

      const grid = document.getElementById('convGrid');
      grid.innerHTML = '';
      const col = j['nome'];

      const players = State.equipe.filter(p => {
        const isStaff = ['eq_tecnica','eq tecnica','eq-tecnica'].some(k => normLower(p[k])==='x');
        if(isStaff) return false;
        return normLower(p[col]) === 'x';
      });

      players.forEach(p => {
        const card = document.createElement('div');
        card.className = 'glass rounded-2xl p-3 hover:translate-y-[-1px] transition';
        const name = p['name'] || p['nome'] || '';
        const pos = p['position'] || p['posição'] || p['posicao'] || '';
        const number = p['number'] || p['número'] || p['numero'] || '';
        const birth = p['birthdate'] || p['data de nascimento'] || p['nascimento'] || '';
        const age = calcAge(birth);
        const photo = p['url_photo'] || '';
        card.innerHTML = `
          <div class="aspect-[4/3] rounded-xl overflow-hidden bg-white/5 shimmer">
            ${photo ? `<img loading="lazy" src="${photo}" class="w-full h-full object-cover" onerror="this.parentElement.innerHTML=avatar('${escapeHtml(name)}')">` : `${avatar(name)}`}
          </div>
          <div class="pt-4">
            <div class="font-semibold break-words">${escapeHtml(name)} ${number?`<span class='text-white/60 font-normal'>· #${number}</span>`:''}</div>
            <div class="text-white/70 text-sm break-words">${escapeHtml(pos)}</div>
            <div class="text-white/60 text-xs mt-1">${birth ? `Nasc.: ${escapeHtml(formatDMShortPT(birth))}${age?` (${age})`:''}`:''}</div>
          </div>`;
        grid.appendChild(card);
      });

      reveal();
    }

    function renderCampeonato(){
      const content = document.getElementById('content');
      if(!State.campeonato || !State.campeonato.length){
        content.innerHTML = '<div class="text-white/70">Sem itens na folha <i>campeonato</i>.</div>'; return;
      }

      const btns = State.campeonato.map(c => `<button class="btn px-3 py-2 rounded-xl border border-white/10 hover:bg-white/10 text-sm" data-item="${escapeHtml(c['item'])}" data-url="${escapeHtml(c['url'])}">${escapeHtml(c['item'])}</button>`).join(' ');

      content.innerHTML = `
        <div class="flex flex-wrap items-center gap-2 mb-6">${btns}</div>
        <div id="campWrap" class="space-y-6"></div>
      `;

      const wrap = document.getElementById('campWrap');
      content.querySelectorAll('[data-item]').forEach(btn => btn.addEventListener('click', () => {
        const url = btn.dataset.url, item = btn.dataset.item;
        wrap.innerHTML = '';
        const panel = document.createElement('div'); panel.className = 'glass rounded-2xl p-3 md:p-4';
        panel.innerHTML = `<div class="mb-2 font-medium text-white/80 break-words">${escapeHtml(item)}</div><img loading="lazy" src="${url}" alt="${escapeHtml(item)}" class="w-full h-auto rounded-xl border border-white/10" />`;
        wrap.appendChild(panel);
        reveal();
      }));

      reveal();
    }

    function setupResponsiveMenu(){
      const navWrap = document.getElementById('navWrap');
      const menu = document.getElementById('menu');
      const toggle = document.getElementById('menuToggle');

      function update(){
        const isMobile = window.matchMedia('(max-width: 767.98px)').matches; // < md
        if(isMobile){
          // Always hamburger on mobile
          toggle.style.display = 'inline-flex';
          navWrap.dataset.mode = 'collapsed';
          return;
        }

        // Desktop behavior: show tabs if they fit, else show hamburger
        const fits = menu.scrollWidth <= navWrap.clientWidth;
        if(fits){
          // hide hamburger (use CSS md:hidden)
          toggle.style.display = '';
          navWrap.dataset.mode = 'desktop';
        }else{
          // force-show hamburger on desktop via inline style (overrides md:hidden)
          toggle.style.display = 'inline-flex';
          navWrap.dataset.mode = 'collapsed';
        }
      }

      update();
      const ro = new ResizeObserver(update);
      ro.observe(document.body);
      window.addEventListener('resize', update);
      window.addEventListener('orientationchange', update);

      toggle.onclick = openOverlayMenu;
      document.getElementById('overlayClose').onclick = closeOverlayMenu;
      document.getElementById('overlayBg').onclick = closeOverlayMenu;

      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape') closeOverlayMenu();
      });
    }

    function openOverlayMenu(){
      document.getElementById('overlayMenu').classList.remove('hidden');
      if (window.lucide) window.lucide.createIcons();
    }
    function closeOverlayMenu(){
      document.getElementById('overlayMenu').classList.add('hidden');
    }

    function renderArquivo(){
      const content = document.getElementById('content');
      if(!State.arquivo || !State.arquivo.length){ content.innerHTML = '<div class="text-white/70">Sem vídeos na folha <i>arquivo</i>.</div>'; return; }
      const list = document.createElement('div'); list.className = 'grid grid-cols-1 gap-6';
      State.arquivo.forEach(r => {
        const title = r['título'] || r['titulo'] || r['title'] || '';
        const link = r['link'] || '';
        const embed = (function(url){
          if(!url) return '';
          try{
            const u = new URL(url);
            if(u.hostname.includes('youtube.com')){ const id = u.searchParams.get('v'); return id ? `https://www.youtube.com/embed/${id}` : url; }
            if(u.hostname === 'youtu.be'){ return `https://www.youtube.com/embed${u.pathname}`; }
            return url;
          }catch(e){ return url; }
        })(link);
        const item = document.createElement('div'); item.className = 'glass rounded-2xl p-4';
        item.innerHTML = `<div class="font-medium mb-3 break-words">${escapeHtml(title)}</div><div class="video-embed"><iframe src="${embed}" title="${escapeHtml(title)}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>`;
        list.appendChild(item);
      });
      content.innerHTML = ''; content.appendChild(list); reveal();
    }

    function renderConvocatoriaWrapper(){
      renderConvocatoria();
    }

    function bootstrap(){
      document.getElementById('year').textContent = new Date().getFullYear();

      if (window.Lenis) {
        const lenis = new Lenis({ lerp: 0.12, smoothWheel: true });
        function raf(time){ lenis.raf(time); requestAnimationFrame(raf); }
        requestAnimationFrame(raf);
      }

      initLoginUI();
      fetchExcelLatest().then(() => {
        if(State.dataLoaded && validateStoredLogin()){
          startApp();
        } else {
          document.getElementById('loader').classList.add('hidden');
          showLogin();
        }
      }).catch(err => {
        console.error(err);
        document.getElementById('loaderText').textContent = 'Erro ao carregar os dados.';
        document.getElementById('loader').classList.add('hidden');
        showLogin();
      });
    }

    function startApp(){
      buildMenu();
      navigate('Plantel');
      const loader = document.getElementById('loader'); loader.classList.add('hidden');
      const app = document.getElementById('app'); requestAnimationFrame(() => { app.style.opacity = 1; });
    }

    window.addEventListener('load', bootstrap);
  </script>
</body>
</html>
